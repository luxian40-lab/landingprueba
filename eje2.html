<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Juego de Ahorcado</title>
    <style>
        body {
            background-color: #111;
            color: #fff;
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .neon {
            color: #39ff14;
            text-shadow: 0 0 5px #39ff14, 0 0 10px #39ff14, 0 0 20px #39ff14;
        }
        .hangman-part {
            display: none;
            font-size: 2em;
            margin: 10px;
        }
        .visible {
            display: inline;
        }
        .letters {
            letter-spacing: 10px;
            font-size: 2em;
        }
        .feedback {
            margin-top: 20px;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <h1 class="neon">Juego de Ahorcado</h1>
    <div id="timer" class="neon">Tiempo: 3:00</div>
    <div id="hangman">
        <canvas id="hangman-canvas" width="400" height="300" style="background:none;display:block;margin:0 auto;"></canvas>
    </div>
    <div class="letters" id="word"></div>
    <div id="input-area">
        <input type="text" id="letter" maxlength="1" autofocus>
        <button onclick="guessLetter()">Adivinar</button>
    </div>
    <div id="opportunities" class="neon">Oportunidades: 3</div>
    <div class="feedback" id="feedback"></div>
    <button id="retryBtn" style="display:none;margin-top:20px;" onclick="retryGame()">Reintentar</button>
    <script>
        // Lista de palabras de exactamente 7 letras
        const palabras = [
            "claudes",
            "neonazo",
            "program",
            "escuela",
            "alumnoz",
            "proceso",
            "trabajo",
            "cultura",
            "sistema"
        ];
        let palabra = "";
        let display = [];
        let oportunidades = 3;
        // Cada parte es una función de dibujo
        let parteActual = 0;
        // Cada error dibuja varias partes
        const partes = [
            function(ctx) { // base + poste
                ctx.shadowColor = '#39ff14'; ctx.shadowBlur = 20;
                ctx.strokeStyle = '#39ff14'; ctx.lineWidth = 6;
                ctx.beginPath(); ctx.moveTo(50, 250); ctx.lineTo(150, 250); ctx.stroke(); // base
                ctx.beginPath(); ctx.moveTo(100, 250); ctx.lineTo(100, 50); ctx.stroke(); // poste
                ctx.shadowBlur = 0;
            },
            function(ctx) { // viga + cuerda
                ctx.shadowColor = '#39ff14'; ctx.shadowBlur = 20;
                ctx.beginPath(); ctx.moveTo(100, 50); ctx.lineTo(220, 50); ctx.stroke(); // viga
                ctx.beginPath(); ctx.moveTo(220, 50); ctx.lineTo(220, 90); ctx.stroke(); // cuerda
                ctx.shadowBlur = 0;
            },
            function(ctx) { // cabeza + cuerpo
                ctx.shadowColor = '#39ff14'; ctx.shadowBlur = 20;
                ctx.beginPath(); ctx.arc(220, 110, 20, 0, Math.PI * 2); ctx.stroke(); // cabeza
                ctx.beginPath(); ctx.moveTo(220, 130); ctx.lineTo(220, 190); ctx.stroke(); // cuerpo
                ctx.shadowBlur = 0;
            },
            function(ctx) { // brazos
                ctx.shadowColor = '#39ff14'; ctx.shadowBlur = 20;
                ctx.beginPath(); ctx.moveTo(220, 150); ctx.lineTo(190, 170); ctx.stroke(); // brazo izq
                ctx.beginPath(); ctx.moveTo(220, 150); ctx.lineTo(250, 170); ctx.stroke(); // brazo der
                ctx.shadowBlur = 0;
            },
            function(ctx) { // piernas
                ctx.shadowColor = '#39ff14'; ctx.shadowBlur = 20;
                ctx.beginPath(); ctx.moveTo(220, 190); ctx.lineTo(200, 230); ctx.stroke(); // pierna izq
                ctx.beginPath(); ctx.moveTo(220, 190); ctx.lineTo(240, 230); ctx.stroke(); // pierna der
                ctx.shadowBlur = 0;
            }
        ];
        let timer = 180;
        let interval;
        let terminado = false;

        function elegirPalabra() {
            // Filtrar solo palabras de exactamente 7 letras
            const palabras7 = palabras.filter(p => p.length === 7);
            return palabras7[Math.floor(Math.random() * palabras7.length)];
        }

        function updateWord() {
            document.getElementById('word').textContent = display.join(' ');
        }
        function updateOpportunities() {
            document.getElementById('opportunities').textContent = "Oportunidades: " + oportunidades;
        }
        function showPart() {
            if (parteActual < partes.length) {
                drawHangman(parteActual);
                parteActual++;
            }
        }
        function drawHangman(partesHasta) {
            const canvas = document.getElementById('hangman-canvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i <= partesHasta; i++) {
                if (partes[i]) partes[i](ctx);
            }
        }
        function guessLetter() {
            if (terminado) return;
            let letra = document.getElementById('letter').value.toLowerCase();
            document.getElementById('letter').value = '';
            if (!letra.match(/[a-zñ]/)) {
                document.getElementById('feedback').textContent = "Ingresa una letra válida.";
                return;
            }
            let acierto = false;
            for (let i = 0; i < palabra.length; i++) {
                if (palabra[i] === letra && display[i] === '_') {
                    display[i] = letra;
                    acierto = true;
                }
            }
            updateWord();
            if (!acierto) {
                oportunidades--;
                showPart();
                updateOpportunities();
                document.getElementById('feedback').textContent = "Letra incorrecta.";
            } else {
                document.getElementById('feedback').textContent = "¡Bien hecho!";
            }
            checkEnd();
        }
        function checkEnd() {
            if (!display.includes('_')) {
                terminado = true;
                clearInterval(interval);
                document.getElementById('feedback').textContent = "¡Ganaste! La palabra era: " + palabra;
                document.getElementById('input-area').style.display = 'none';
                document.getElementById('retryBtn').style.display = 'inline';
            } else if (oportunidades === 0) {
                terminado = true;
                clearInterval(interval);
                document.getElementById('feedback').textContent = "Perdiste. La palabra era: " + palabra;
                document.getElementById('input-area').style.display = 'none';
                document.getElementById('retryBtn').style.display = 'inline';
            }
        }
        function updateTimer() {
            let min = Math.floor(timer / 60);
            let sec = timer % 60;
            document.getElementById('timer').textContent = `Tiempo: ${min}:${sec.toString().padStart(2, '0')}`;
            if (timer === 0) {
                terminado = true;
                clearInterval(interval);
                document.getElementById('feedback').textContent = "Tiempo agotado. La palabra era: " + palabra;
                document.getElementById('input-area').style.display = 'none';
                document.getElementById('retryBtn').style.display = 'inline';
            }
            timer--;
        }
        function startGame() {
            palabra = elegirPalabra();
            display = Array(palabra.length).fill('_');
            oportunidades = 5;
            parteActual = 0;
            timer = 180;
            terminado = false;
            document.getElementById('feedback').textContent = '';
            document.getElementById('input-area').style.display = 'block';
            document.getElementById('retryBtn').style.display = 'none';
            drawHangman(-1);
            updateWord();
            updateOpportunities();
            updateTimer();
            clearInterval(interval);
            interval = setInterval(updateTimer, 1000);
        }
        function retryGame() {
            startGame();
        }
        startGame();
    </script>
</body>
</html>
